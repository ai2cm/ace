<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="Modules" href="modules.html" />

    <link rel="shortcut icon" href="_static/Ai2_icon_pink_RGB.png"/><!-- Generated with Sphinx 7.0.0 and Furo 2024.04.27 -->
        <title>API Reference - fme v2025.7.0</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=46965ee0ad39e5260c2467c27b94afaae98bd900" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">fme v2025.7.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/Ai2_icon_pink_padding_RGB.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/Ai2_icon_pink_padding_RGB.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">fme v2025.7.0</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="training_config.html">Training Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference_config.html">Inference Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluator_config.html">Evaluator Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="gcs_access.html">Accessing data via Google Cloud Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder.html">The Builder Pattern: Modern Namelists</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">API Reference</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="api-reference">
<span id="id1"></span><h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this heading">¶</a></h1>
<section id="module-fme">
<span id="fme"></span><h2>fme<a class="headerlink" href="#module-fme" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fme.Packer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">Packer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/packer.html#Packer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.Packer" title="Permalink to this definition">¶</a></dt>
<dd><p>Responsible for packing tensors into a single tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – </p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.Packer.pack">
<span class="sig-name descname"><span class="pre">pack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/packer.html#Packer.pack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.Packer.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Packs tensors into a single tensor, concatenated along a new axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – Dict from names to tensors.</p></li>
<li><p><strong>axis</strong> (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) – index for new concatenation axis.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>DataShapesNotUniform</strong> – when packed tensors do not all have the same shape.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.StandardNormalizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">StandardNormalizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_nans_on_normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_nans_on_denormalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/normalizer.html#StandardNormalizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.StandardNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Responsible for normalizing tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>means</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>torch.Tensor</em><em>]</em>) – </p></li>
<li><p><strong>stds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>torch.Tensor</em><em>]</em>) – </p></li>
<li><p><strong>fill_nans_on_normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
<li><p><strong>fill_nans_on_denormalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.StandardNormalizer.from_state">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/normalizer.html#StandardNormalizer.from_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.StandardNormalizer.from_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads state from a serializable data structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fme.StandardNormalizer" title="fme.core.normalizer.StandardNormalizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">StandardNormalizer</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fme.StandardNormalizer.get_state">
<span class="sig-name descname"><span class="pre">get_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/normalizer.html#StandardNormalizer.get_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.StandardNormalizer.get_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns state as a serializable data structure.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fme.get_device">
<span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">get_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/device.html#get_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.get_device" title="Permalink to this definition">¶</a></dt>
<dd><p>If CUDA is available, return a CUDA device. Otherwise, return a CPU device
unless FME_USE_MPS is set, in which case return an MPS device if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fme.gradient_magnitude">
<span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">gradient_magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/metrics.html#gradient_magnitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.gradient_magnitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the magnitude of gradient across the specified dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>tensor</strong> (<em>Tensor</em>) – </p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><em>Iterable</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fme.gradient_magnitude_percent_diff">
<span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">gradient_magnitude_percent_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">truth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/metrics.html#gradient_magnitude_percent_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.gradient_magnitude_percent_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the percent difference of the weighted mean gradient magnitude across
the specified dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>truth</strong> (<em>Tensor</em>) – </p></li>
<li><p><strong>predicted</strong> (<em>Tensor</em>) – </p></li>
<li><p><strong>weights</strong> (<em>Tensor</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><em>Iterable</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fme.rmse_of_time_mean">
<span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">rmse_of_time_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">truth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-2,</span> <span class="pre">-1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/metrics.html#rmse_of_time_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.rmse_of_time_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the RMSE of the time-average given truth and predicted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>truth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – truth tensor</p></li>
<li><p><strong>predicted</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – predicted tensor</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – weights to use for computing spatial RMSE</p></li>
<li><p><strong>time_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) – time dimension</p></li>
<li><p><strong>spatial_dims</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">(-2,</span> <span class="pre">-1)</span></code>) – spatial dimensions over which RMSE is calculated</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>The RMSE between the time-mean of the two input tensors. The time and</dt><dd><p>spatial dims are reduced.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fme.root_mean_squared_error">
<span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">root_mean_squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">truth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/metrics.html#root_mean_squared_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.root_mean_squared_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a weighted root mean square error between truth and predicted.</p>
<p>Namely:</p>
<blockquote>
<div><p>sqrt((weights * ((xhat - x) ** 2)).mean(dims))</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>truth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – torch.Tensor whose last dimensions are to be weighted</p></li>
<li><p><strong>predicted</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – torch.Tensor whose last dimensions are to be weighted</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – torch.Tensor to apply to the squared bias.</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">()</span></code>) – Dimensions to average over.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tensor of weighted RMSEs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fme.spherical_area_weights">
<span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">spherical_area_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_lon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/metrics.html#spherical_area_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.spherical_area_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes area weights given the latitudes of a regular lat-lon grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lats</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – tensor of shape (…, num_lat,) with the latitudes of
the cell centers.</p></li>
<li><p><strong>num_lon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of longitude points.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a torch.tensor of shape (num_lat, num_lon).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fme.time_and_global_mean_bias">
<span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">time_and_global_mean_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">truth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-2,</span> <span class="pre">-1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/metrics.html#time_and_global_mean_bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.time_and_global_mean_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the global- and time-mean bias given truth and predicted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>truth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – truth tensor</p></li>
<li><p><strong>predicted</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – predicted tensor</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – weights to use for computing the global mean</p></li>
<li><p><strong>time_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) – time dimension</p></li>
<li><p><strong>spatial_dims</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">(-2,</span> <span class="pre">-1)</span></code>) – spatial dimensions over which global mean is calculated</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>The global- and time-mean bias between the predicted and truth tensors. The</dt><dd><p>time and spatial dims are reduced.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fme.weighted_mean">
<span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">weighted_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/metrics.html#weighted_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.weighted_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the weighted mean across the specified list of dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – torch.Tensor</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Weights to apply to the mean.</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">()</span></code>) – Dimensions to compute the mean over.</p></li>
<li><p><strong>keepdim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether the output tensor has <cite>dim</cite> retained or not.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a tensor of the weighted mean averaged over the specified dimensions <cite>dim</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fme.weighted_mean_bias">
<span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">weighted_mean_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">truth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/metrics.html#weighted_mean_bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.weighted_mean_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the mean bias across the specified list of dimensions assuming
that the weights are applied to the last dimensions, e.g. the spatial dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>truth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – torch.Tensor</p></li>
<li><p><strong>predicted</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – torch.Tensor</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">()</span></code>) – Dimensions to compute the mean over.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Weights to apply to the mean.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a tensor of the mean biases averaged over the specified dimensions <cite>dim</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fme.weighted_mean_gradient_magnitude">
<span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">weighted_mean_gradient_magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/metrics.html#weighted_mean_gradient_magnitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.weighted_mean_gradient_magnitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute weighted mean of gradient magnitude across the specified dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>tensor</strong> (<em>Tensor</em>) – </p></li>
<li><p><strong>weights</strong> (<em>Tensor</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><em>Iterable</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fme.weighted_std">
<span class="sig-prename descclassname"><span class="pre">fme.</span></span><span class="sig-name descname"><span class="pre">weighted_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/metrics.html#weighted_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.weighted_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the weighted standard deviation across the specified list of dimensions.</p>
<p>Computed by first computing the weighted variance, then taking the square root.</p>
<p>weighted_variance = weighted_mean((tensor - weighted_mean(tensor)) ** 2)) ** 0.5</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – torch.Tensor</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Weights to apply to the variance.</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">()</span></code>) – Dimensions to compute the standard deviation over.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>a tensor of the weighted standard deviation over the</dt><dd><p>specified dimensions <cite>dim</cite>.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fme.ace">
<span id="fme-ace"></span><h2>fme.ace<a class="headerlink" href="#module-fme.ace" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.AtmosphereCorrectorConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">AtmosphereCorrectorConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conserve_dry_air=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_global_mean_moisture_advection=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moisture_budget_correction=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_positive_names=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_energy_budget_correction=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/corrector/atmosphere.html#AtmosphereCorrectorConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.AtmosphereCorrectorConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the post-step state corrector.</p>
<p><code class="docutils literal notranslate"><span class="pre">conserve_dry_air</span></code> enforces the constraint that:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[global\_dry\_air = global\_mean(ps -
sum_k((ak\_diff + bk\_diff \* ps) \* wat_k))\]</div>
</div>
<p>in the generated data is equal to its value in the input data. This is done
by adding a globally-constant correction to the surface pressure in each
column. As per-mass values such as mixing ratios of water are unchanged,
this can cause changes in total water or energy. Note all global means here
are area-weighted.</p>
<p><code class="docutils literal notranslate"><span class="pre">zero_global_mean_moisture_advection</span></code> enforces the constraint that:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[global\_mean(tendency\_of\_total\_water\_path\_due\_to\_advection) = 0\]</div>
</div>
<p>in the generated data. This is done by adding a globally-constant correction
to the moisture advection tendency in each column.</p>
<p><code class="docutils literal notranslate"><span class="pre">moisture_budget_correction</span></code> enforces closure of the moisture budget equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}tendency\_of\_total\_water\_path = (evaporation\_rate - precipitation\_rate
\\\\ + tendency\_of\_total\_water\_path\_due\_to\_advection)\end{split}\]</div>
</div>
<p>in the generated data, where <code class="docutils literal notranslate"><span class="pre">tendency_of_total_water_path</span></code> is the difference
between the total water path at the current timestep and the previous
timestep divided by the time difference. This is done by modifying the
precipitation, evaporation, and/or moisture advection tendency fields as
described in the <code class="docutils literal notranslate"><span class="pre">moisture_budget_correction</span></code> attribute. When
advection tendency is modified, this budget equation is enforced in each
column, while when only precipitation or evaporation are modified, only
the global mean of the budget equation is enforced.</p>
<p>When enforcing moisture budget closure, we assume the global mean moisture
advection is zero. Therefore <code class="docutils literal notranslate"><span class="pre">zero_global_mean_moisture_advection</span></code> must be
True if using a <code class="docutils literal notranslate"><span class="pre">moisture_budget_correction</span></code> option other than <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conserve_dry_air</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – If True, force the generated data to conserve dry air
by subtracting a constant offset from the surface pressure of each
column. This can cause changes in per-mass values such as total water
or energy.</p></li>
<li><p><strong>zero_global_mean_moisture_advection</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – If True, force the generated data to
have zero global mean moisture advection by subtracting a constant
offset from the moisture advection tendency of each column.</p></li>
<li><p><strong>moisture_budget_correction</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'precipitation'</span></code>, <code class="docutils literal notranslate"><span class="pre">'evaporation'</span></code>, <code class="docutils literal notranslate"><span class="pre">'advection_and_precipitation'</span></code>, <code class="docutils literal notranslate"><span class="pre">'advection_and_evaporation'</span></code>]], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – <p>If not “None”, force the generated data to
conserve global or column-local moisture by modifying budget fields.
Options are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">precipitation</span></code>: multiply precipitation by a scale factor
to close the global moisture budget.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">evaporation</span></code>: multiply evaporation by a scale factor
to close the global moisture budget.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">advection_and_precipitation</span></code>: after applying the “precipitation”
global-mean correction above, recompute the column-integrated
advective tendency as the budget residual,
ensuring column budget closure.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">advection_and_evaporation</span></code>: after applying the “evaporation”
global-mean correction above, recompute the column-integrated
advective tendency as the budget residual,
ensuring column budget closure.</p></li>
</ul>
</p></li>
<li><p><strong>force_positive_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Names of fields that should be forced to be greater
than or equal to zero. This is useful for fields like precipitation.</p></li>
<li><p><strong>total_energy_budget_correction</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyBudgetConfig</span></code>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – If not None, force the generated data to
conserve an idealized version of total energy using the provided
configuration.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.AugmentationConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">AugmentationConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rotate_probability=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_directional_names=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/augmentation.html#AugmentationConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.AugmentationConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for data augmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rotate_probability</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – </p></li>
<li><p><strong>additional_directional_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="fme.ace.AugmentationConfig.rotate_probability">
<span class="sig-name descname"><span class="pre">rotate_probability</span></span><a class="headerlink" href="#fme.ace.AugmentationConfig.rotate_probability" title="Permalink to this definition">¶</a></dt>
<dd><p>The probability of rotating the sphere by 180 degrees,
as a value between 0.0 and 1.0.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fme.ace.AugmentationConfig.additional_directional_names">
<span class="sig-name descname"><span class="pre">additional_directional_names</span></span><a class="headerlink" href="#fme.ace.AugmentationConfig.additional_directional_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of variables whose sign is flipped when
the poles are reversed. By default this includes known directional
names as stored in RotateModifier.FLIP_NAMES.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.CappedGELUConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">CappedGELUConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cap_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_nhwc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_healpixpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_activations.html#CappedGELUConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.CappedGELUConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the CappedGELU activation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cap_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">10</span></code>) – Cap value for the GELU function, default is 10.</p></li>
<li><p><strong>enable_nhwc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable NHWC data format, default is False.</p></li>
<li><p><strong>enable_healpixpad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable HEALPix padding, default is False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.CappedGELUConfig.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_activations.html#CappedGELUConfig.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.CappedGELUConfig.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the CappedGELU activation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CappedGELU activation function.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.ConcatDatasetConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">ConcatDatasetConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">concat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/dataset/config.html#ConcatDatasetConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ConcatDatasetConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for concatenating multiple datasets.
:type concat: <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference internal" href="#fme.ace.XarrayDataConfig" title="fme.core.dataset.config.XarrayDataConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">XarrayDataConfig</span></code></a>]
:param concat: List of XarrayDataConfig objects to concatenate.
:type strict: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>
:param strict: Whether to enforce that the datasets to be concatenated</p>
<blockquote>
<div><p>have the same dimensions and coordinates.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>concat</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference internal" href="#fme.ace.XarrayDataConfig" title="fme.core.dataset.config.XarrayDataConfig"><em>XarrayDataConfig</em></a><em>]</em>) – </p></li>
<li><p><strong>strict</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.ConstantConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">ConstantConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/perturbation.html#ConstantConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ConstantConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for a constant perturbation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>amplitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.ConvBlockConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">ConvBlockConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upscale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_nhwc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_healpixpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BasicConvBlock'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_blocks.html#ConvBlockConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ConvBlockConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the convolutional block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">3</span></code>) – Number of input channels, default is 3.</p></li>
<li><p><strong>out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Number of output channels, default is 1.</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">3</span></code>) – Size of the kernel, default is 3.</p></li>
<li><p><strong>dilation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Dilation rate, default is 1.</p></li>
<li><p><strong>n_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Number of layers, default is 1.</p></li>
<li><p><strong>upsampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">UpsamplingBlockConfig</span></code>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Upsampling factor for TransposedConvUpsample, default is 2.</p></li>
<li><p><strong>upscale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">4</span></code>) – Upscale factor for ConvNeXtBlock and SymmetricConvNeXtBlock,
default is 4.</p></li>
<li><p><strong>latent_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Number of latent channels, default is None.</p></li>
<li><p><strong>activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.CappedGELUConfig" title="fme.ace.models.healpix.healpix_activations.CappedGELUConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">CappedGELUConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Activation configuration, default is None.</p></li>
<li><p><strong>enable_nhwc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable NHWC data format, default is False.</p></li>
<li><p><strong>enable_healpixpad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable HEALPix padding, default is False.</p></li>
<li><p><strong>block_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'BasicConvBlock'</span></code>, <code class="docutils literal notranslate"><span class="pre">'ConvNeXtBlock'</span></code>, <code class="docutils literal notranslate"><span class="pre">'SymmetricConvNeXtBlock'</span></code>, <code class="docutils literal notranslate"><span class="pre">'ConvThenUpsample'</span></code>, <code class="docutils literal notranslate"><span class="pre">'TransposedConvUpsample'</span></code>], default: <code class="docutils literal notranslate"><span class="pre">'BasicConvBlock'</span></code>) – Type of block, default is “BasicConvBlock”.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.ConvBlockConfig.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_blocks.html#ConvBlockConfig.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ConvBlockConfig.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the convolutional block model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Convolutional block model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.CopyWeightsConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">CopyWeightsConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/weight_ops.html#CopyWeightsConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.CopyWeightsConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for copying weights from a base model to a target model.</p>
<p>Used during training to overwrite weights after every batch of data,
to have the effect of “freezing” the overwritten weights. When the
target parameters have longer dimensions than the base model, only
the initial slice is overwritten.</p>
<p>This is used to achieve an effect of freezing model parameters that
can freeze a subset of each weight that comes from a smaller base weight.
This is less efficient than true parameter freezing, but layer
freezing is all-or-nothing for each parameter.</p>
<p>All parameters must be covered by either the include or exclude list,
but not both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – list of wildcard patterns to overwrite</p></li>
<li><p><strong>exclude</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – list of wildcard patterns to exclude from overwriting</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.CopyWeightsConfig.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modules</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/weight_ops.html#CopyWeightsConfig.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.CopyWeightsConfig.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply base weights to modules according to the include/exclude lists
of this instance.</p>
<p>In order to “freeze” the weights during training, this must be called after
each time the weights are updated in the training loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]) – list of base weights to apply</p></li>
<li><p><strong>modules</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>]) – list of modules to apply the weights to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.CorrectorSelector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">CorrectorSelector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/registry/corrector.html#CorrectorSelector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.CorrectorSelector" title="Permalink to this definition">¶</a></dt>
<dd><p>A dataclass containing all the information needed to build a
CorrectorConfigProtocol, including the type of the CorrectorConfigProtocol
and the data needed to build it.</p>
<p>This is helpful as CorrectorSelector can be serialized and deserialized
without any additional information, whereas to load a
CorrectorConfigProtocol you would need to know the type of the
CorrectorConfigProtocol being loaded.</p>
<p>It is also convenient because CorrectorSelector is a single class that can
be used to represent any CorrectorConfigProtocol, whereas
CorrectorConfigProtocol is a protocol that can be implemented by many
different classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the type of the CorrectorConfigProtocol</p></li>
<li><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – data for a CorrectorConfigProtocol instance of the indicated type</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.CorrectorSelector.get_available_types">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_available_types</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/registry/corrector.html#CorrectorSelector.get_available_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.CorrectorSelector.get_available_types" title="Permalink to this definition">¶</a></dt>
<dd><p>This class method is used to expose all available types of Correctors.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.DataLoaderConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">DataLoaderConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_data_workers=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefetch_factor=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentation=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_with_replacement=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_buffer=0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/config.html#DataLoaderConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.DataLoaderConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the data loader.</p>
<dl class="simple">
<dt>Note: Setting <cite>time_buffer</cite> to a value greater than 0 results in pre-loading</dt><dd><p>samples of length <cite>time_buffer + n_timesteps_required</cite>, where
<cite>n_timesteps_required</cite> is the number of timesteps required for training
the model (initial condition(s) plus forward step(s)). These pre-loaded samples
become a window from which samples of the required length are drawn without
replacement. The windows will overlap by an amount such that no samples are
skipped, with exception of the last window, which is dropped if incomplete.
This is useful for improving data loading throughput and reducing the number of
reads. There must be enough pre-loaded samples in the dataset to produce at
least one batch at the configured batch size. Independent data will be seen
every <cite>time_buffer + 1</cite> batches, i.e., this is the number of samples in each
pre-loaded window.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="#fme.ace.ConcatDatasetConfig" title="fme.core.dataset.config.ConcatDatasetConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConcatDatasetConfig</span></code></a> | <a class="reference internal" href="#fme.ace.MergeDatasetConfig" title="fme.core.dataset.config.MergeDatasetConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">MergeDatasetConfig</span></code></a> | <a class="reference internal" href="#fme.ace.XarrayDataConfig" title="fme.core.dataset.config.XarrayDataConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">XarrayDataConfig</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference internal" href="#fme.ace.XarrayDataConfig" title="fme.core.dataset.config.XarrayDataConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">XarrayDataConfig</span></code></a>]) – Could be a single dataset configuration,
or a sequence of datasets to be concatenated using the keyword <cite>concat</cite>,
or datasets from different sources to be merged using the keyword <cite>merge</cite>.
For backwards compatibility, it can also be a sequence of
datasets, which will be concatenated.
During <cite>merge</cite>, if multiple datasets contain the same data variable,
the version from the first source is loaded and other sources are ignored.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of samples per batch.</p></li>
<li><p><strong>num_data_workers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) – Number of parallel workers to use for data loading.</p></li>
<li><p><strong>prefetch_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – how many batches a single data worker will attempt to
hold in host memory at a given time.</p></li>
<li><p><strong>augmentation</strong> (<a class="reference internal" href="#fme.ace.AugmentationConfig" title="fme.ace.data_loading.augmentation.AugmentationConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">AugmentationConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Configuration for data augmentation.</p></li>
<li><p><strong>sample_with_replacement</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – If provided, the dataset will be
sampled randomly with replacement to the given size each period,
instead of retrieving each sample once (either shuffled or not).</p></li>
<li><p><strong>time_buffer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) – How many more continuous timesteps to load in memory than the
required number of timesteps for a single batch. Setting this to greater
than 0 should improve data loading performance, however, it also decreases
the independence of subsequent batches if shuffled batches are desired.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.DataLoaderConfig.zarr_engine_used">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zarr_engine_used</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#fme.ace.DataLoaderConfig.zarr_engine_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether any of the configured datasets are using the Zarr engine.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.DataWriterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">DataWriterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_extended_video_netcdfs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_prediction_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_monthly_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_histogram_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_coarsen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/inference/data_writer/main.html#DataWriterConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.DataWriterConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for inference data writers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_extended_video_netcdfs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to enable writing of netCDF files
containing video metrics.</p></li>
<li><p><strong>save_prediction_files</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to enable writing of netCDF files
containing the predictions and target values.</p></li>
<li><p><strong>save_monthly_files</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to enable writing of netCDF files
containing the monthly predictions and target values.</p></li>
<li><p><strong>names</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Names of variables to save in the prediction, histogram, and monthly
netCDF files.</p></li>
<li><p><strong>save_histogram_files</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Enable writing of netCDF files containing histograms.</p></li>
<li><p><strong>time_coarsen</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.TimeCoarsenConfig" title="fme.ace.inference.data_writer.time_coarsen.TimeCoarsenConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeCoarsenConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Configuration for time coarsening of written outputs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.DownsamplingBlockConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">DownsamplingBlockConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pooling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_nhwc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_healpixpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_activations.html#DownsamplingBlockConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.DownsamplingBlockConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the downsampling block.
Generally, either a pooling block or a striding conv block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>block_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'MaxPool'</span></code>, <code class="docutils literal notranslate"><span class="pre">'AvgPool'</span></code>]) – Type of recurrent block, either “MaxPool” or “AvgPool”</p></li>
<li><p><strong>pooling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">2</span></code>) – Pooling size</p></li>
<li><p><strong>enable_nhwc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable NHWC data format, default is False.</p></li>
<li><p><strong>enable_healpixpad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable HEALPix padding, default is False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.DownsamplingBlockConfig.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_activations.html#DownsamplingBlockConfig.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.DownsamplingBlockConfig.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the recurrent block model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Recurrent block.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.EMAConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">EMAConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9999</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/ema.html#EMAConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.EMAConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for exponential moving average of model weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0.9999</span></code>) – decay rate for the moving average</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.ExistingStepperConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">ExistingStepperConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#ExistingStepperConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ExistingStepperConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for an existing stepper. This allows loading a serialized
stepper from a checkpoint without loading its configuration of the training
and optimization schedule, i.e., this allows for specifying a new
schedule in fine-tuning. Not used for training resumption.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – The path to the serialized checkpoint; should be different</p></li>
<li><p><strong>directory.</strong> (<em>than the experiment output</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.ExistingStepperConfig.get_parameter_initializer">
<span class="sig-name descname"><span class="pre">get_parameter_initializer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#ExistingStepperConfig.get_parameter_initializer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ExistingStepperConfig.get_parameter_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a parameter initializer for this stepper configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterInitializer</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.ExplicitIndices">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">ExplicitIndices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/inference.html#ExplicitIndices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ExplicitIndices" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure indices providing them explicitly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>list</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – List of integer indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.FillNaNsConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">FillNaNsConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'constant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/dataset/config.html#FillNaNsConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.FillNaNsConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration to fill NaNs with a constant value or others.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'constant'</span></code>], default: <code class="docutils literal notranslate"><span class="pre">'constant'</span></code>) – Type of fill operation. Currently only ‘constant’ is supported.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0.0</span></code>) – Value to fill NaNs with.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.ForcingDataLoaderConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">ForcingDataLoaderConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_data_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perturbations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistence_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/inference.html#ForcingDataLoaderConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ForcingDataLoaderConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the forcing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="#fme.ace.XarrayDataConfig" title="fme.core.dataset.config.XarrayDataConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">XarrayDataConfig</span></code></a> | <a class="reference internal" href="#fme.ace.MergeNoConcatDatasetConfig" title="fme.core.dataset.config.MergeNoConcatDatasetConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">MergeNoConcatDatasetConfig</span></code></a>) – Configuration to define the dataset.</p></li>
<li><p><strong>num_data_workers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) – Number of parallel workers to use for data loading.</p></li>
<li><p><strong>perturbations</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.SSTPerturbation" title="fme.ace.data_loading.perturbation.SSTPerturbation"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSTPerturbation</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Configuration for SST perturbations
used in forcing data.</p></li>
<li><p><strong>persistence_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Names of variables for which all returned values
will be the same as the initial condition. When evaluating initial
condition predictability, set this to forcing variables that should
not be updated during inference (e.g. surface temperature).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.FrozenParameterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">FrozenParameterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/parameter_init.html#FrozenParameterConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.FrozenParameterConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for freezing parameters in a model.</p>
<p>Parameter names can include wildcards, e.g. “encoder.*” will select
all parameters in the encoder, while “encoder.*.bias” will select all
bias parameters in the encoder. All parameters must be specified
in either the include or exclude list, or
an exception will be raised.</p>
<p>An exception is raised if a parameter is included by both lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – list of parameter names to freeze (set requires_grad = False)</p></li>
<li><p><strong>exclude</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – list of parameter names to ignore</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.GreensFunctionConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">GreensFunctionConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/perturbation.html#GreensFunctionConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.GreensFunctionConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for a single sinusoidal patch of a Green’s function perturbation.
See equation 1 in Bloch‐Johnson, J., et al. (2024).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amplitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1.0</span></code>) – The amplitude of the perturbation,
maximum is reached at (lat_center, lon_center).</p></li>
<li><p><strong>lat_center</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0.0</span></code>) – The latitude at the center of the patch in degrees.</p></li>
<li><p><strong>lon_center</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0.0</span></code>) – The longitude at the center of the patch in degrees.</p></li>
<li><p><strong>lat_width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">10.0</span></code>) – latitudinal width of the patch in degrees.</p></li>
<li><p><strong>lon_width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">10.0</span></code>) – longitudinal width of the patch in degrees.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.GriddedOperations">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">GriddedOperations</span></span><a class="reference internal" href="_modules/fme/core/gridded_ops.html#GriddedOperations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.GriddedOperations" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="fme.ace.GriddedOperations.from_state">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/gridded_ops.html#GriddedOperations.from_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.GriddedOperations.from_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a dictionary with a “type” key and a “state” key, return
the GriddedOperations it describes.</p>
<p>The “type” key should be the name of a subclass of GriddedOperations,
and the “state” key should be a dictionary specific to
that subclass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A dictionary with a “type” key and a “state” key.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#fme.ace.GriddedOperations" title="fme.core.gridded_ops.GriddedOperations"><code class="xref py py-class docutils literal notranslate"><span class="pre">GriddedOperations</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An instance of the subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.GriddedOperations.get_initialization_kwargs">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_initialization_kwargs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/gridded_ops.html#GriddedOperations.get_initialization_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.GriddedOperations.get_initialization_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the keyword arguments needed to initialize the instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.HEALPixRecUNetBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">HEALPixRecUNetBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">presteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_time_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_time_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'6h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'24h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_constants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_input_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prognostic_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_nhwc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_healpixpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/registry/hpx.html#HEALPixRecUNetBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.HEALPixRecUNetBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the HEALPixRecUNet architecture used in DLWP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>presteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Number of pre-steps, by default 1.</p></li>
<li><p><strong>input_time_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) – Input time dimension, by default 0.</p></li>
<li><p><strong>output_time_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) – Output time dimension, by default 0.</p></li>
<li><p><strong>delta_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">'6h'</span></code>) – Delta time interval, by default “6h”.</p></li>
<li><p><strong>reset_cycle</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">'24h'</span></code>) – Reset cycle interval, by default “24h”.</p></li>
<li><p><strong>input_channels</strong> – Number of input channels, by default 8.</p></li>
<li><p><strong>output_channels</strong> – Number of output channels, by default 8.</p></li>
<li><p><strong>n_constants</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">2</span></code>) – Number of constant input channels, by default 2.</p></li>
<li><p><strong>decoder_input_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Number of input channels for the decoder, by default 1.</p></li>
<li><p><strong>enable_nhwc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable NHWC data format, by default False.</p></li>
<li><p><strong>enable_healpixpad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable HEALPix padding, by default False.</p></li>
<li><p><strong>encoder</strong> (<a class="reference internal" href="#fme.ace.UNetEncoderConfig" title="fme.ace.models.healpix.healpix_encoder.UNetEncoderConfig"><em>UNetEncoderConfig</em></a>) – </p></li>
<li><p><strong>decoder</strong> (<a class="reference internal" href="#fme.ace.UNetDecoderConfig" title="fme.ace.models.healpix.healpix_decoder.UNetDecoderConfig"><em>UNetDecoderConfig</em></a>) – </p></li>
<li><p><strong>prognostic_variables</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.HEALPixRecUNetBuilder.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/registry/hpx.html#HEALPixRecUNetBuilder.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.HEALPixRecUNetBuilder.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the HEALPixRecUNet model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of input channels.</p></li>
<li><p><strong>n_out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of output channels.</p></li>
<li><p><strong>img_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – Shape of the input image.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>HEALPixRecUNet model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.InferenceAggregatorConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">InferenceAggregatorConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_mean_reference_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_global_mean_time_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/aggregator/inference/main.html#InferenceAggregatorConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.InferenceAggregatorConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for inference aggregator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_mean_reference_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Path to reference time means to compare against.</p></li>
<li><p><strong>log_global_mean_time_series</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to log global mean time series metrics.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.InferenceConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">InferenceConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_forward_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_condition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forcing_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_steps_in_memory=10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_writer=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregator=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepper_override=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incompatible_dataset=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/inference/inference.html#InferenceConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.InferenceConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for running inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Directory to save results to.</p></li>
<li><p><strong>n_forward_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of steps to run the model forward for.</p></li>
<li><p><strong>checkpoint_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to stepper checkpoint to load.</p></li>
<li><p><strong>logging</strong> (<a class="reference internal" href="#fme.ace.LoggingConfig" title="fme.core.logging_utils.LoggingConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoggingConfig</span></code></a>) – Configuration for logging.</p></li>
<li><p><strong>initial_condition</strong> (<a class="reference internal" href="#fme.ace.InitialConditionConfig" title="fme.ace.inference.inference.InitialConditionConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">InitialConditionConfig</span></code></a>) – Configuration for initial condition data.</p></li>
<li><p><strong>forcing_loader</strong> (<a class="reference internal" href="#fme.ace.ForcingDataLoaderConfig" title="fme.ace.data_loading.inference.ForcingDataLoaderConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForcingDataLoaderConfig</span></code></a>) – Configuration for forcing data.</p></li>
<li><p><strong>forward_steps_in_memory</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">10</span></code>) – Number of forward steps to complete in memory
at a time.</p></li>
<li><p><strong>data_writer</strong> (<a class="reference internal" href="#fme.ace.DataWriterConfig" title="fme.ace.inference.data_writer.main.DataWriterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataWriterConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Configuration for data writers.</p></li>
<li><p><strong>aggregator</strong> (<a class="reference internal" href="#fme.ace.InferenceAggregatorConfig" title="fme.ace.aggregator.inference.main.InferenceAggregatorConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">InferenceAggregatorConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Configuration for inference aggregator.</p></li>
<li><p><strong>stepper_override</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.StepperOverrideConfig" title="fme.ace.stepper.single_module.StepperOverrideConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepperOverrideConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Configuration for overriding select stepper configuration
options at inference time (optional).</p></li>
<li><p><strong>allow_incompatible_dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – If True, allow the dataset used for inference
to be incompatible with the dataset used for stepper training. This should
be used with caution, as it may allow the stepper to make scientifically
invalid predictions, but it can allow running inference with incorrectly
formatted or missing grid information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.InferenceDataLoaderConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">InferenceDataLoaderConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_data_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perturbations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistence_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/inference.html#InferenceDataLoaderConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.InferenceDataLoaderConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for inference data.</p>
<p>This is like the <cite>DataLoaderConfig</cite> class, but with some additional
constraints. During inference, we have only one batch, so the number of
samples directly determines the size of that batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="#fme.ace.XarrayDataConfig" title="fme.core.dataset.config.XarrayDataConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">XarrayDataConfig</span></code></a> | <a class="reference internal" href="#fme.ace.MergeNoConcatDatasetConfig" title="fme.core.dataset.config.MergeNoConcatDatasetConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">MergeNoConcatDatasetConfig</span></code></a>) – Configuration to define the dataset.</p></li>
<li><p><strong>start_indices</strong> (<a class="reference internal" href="#fme.ace.InferenceInitialConditionIndices" title="fme.ace.data_loading.inference.InferenceInitialConditionIndices"><code class="xref py py-class docutils literal notranslate"><span class="pre">InferenceInitialConditionIndices</span></code></a> | <a class="reference internal" href="#fme.ace.ExplicitIndices" title="fme.ace.data_loading.inference.ExplicitIndices"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExplicitIndices</span></code></a> | <a class="reference internal" href="#fme.ace.TimestampList" title="fme.ace.data_loading.inference.TimestampList"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimestampList</span></code></a>) – Configuration of the indices for initial conditions
during inference. This can be a list of timestamps, a list of
integer indices, or a slice configuration of the integer indices.
Values following the initial condition will still come from
the full dataset.</p></li>
<li><p><strong>num_data_workers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) – Number of parallel workers to use for data loading.</p></li>
<li><p><strong>perturbations</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.SSTPerturbation" title="fme.ace.data_loading.perturbation.SSTPerturbation"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSTPerturbation</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Configuration for SST perturbations.</p></li>
<li><p><strong>persistence_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Names of variables for which all returned values
will be the same as the initial condition. When evaluating initial
condition predictability, set this to forcing variables that should
not be updated during inference (e.g. surface temperature).</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.InferenceDataLoaderConfig.zarr_engine_used">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zarr_engine_used</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#fme.ace.InferenceDataLoaderConfig.zarr_engine_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether any of the configured datasets are using the Zarr engine.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.InferenceEvaluatorAggregatorConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">InferenceEvaluatorAggregatorConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_histograms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_video</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_extended_video</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_zonal_mean_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_seasonal_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_global_mean_time_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_global_mean_norm_time_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly_reference_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_mean_reference_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/aggregator/inference/main.html#InferenceEvaluatorAggregatorConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.InferenceEvaluatorAggregatorConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for inference evaluator aggregator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_histograms</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to log histograms of the targets and predictions.</p></li>
<li><p><strong>log_video</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to log videos of the state evolution.</p></li>
<li><p><strong>log_extended_video</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to log wandb videos of the predictions with
statistical metrics, only done if log_video is True.</p></li>
<li><p><strong>log_zonal_mean_images</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to log zonal-mean images (hovmollers) with a
time dimension.</p></li>
<li><p><strong>log_seasonal_means</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to log seasonal mean metrics and images.</p></li>
<li><p><strong>log_global_mean_time_series</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to log global mean time series metrics.</p></li>
<li><p><strong>log_global_mean_norm_time_series</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to log the normalized global mean
time series metrics.</p></li>
<li><p><strong>monthly_reference_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Path to monthly reference data to compare against.</p></li>
<li><p><strong>time_mean_reference_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Path to reference time means to compare against.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.InferenceEvaluatorConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">InferenceEvaluatorConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_forward_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_loader=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_steps_in_memory=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_writer=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregator=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepper_override=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incompatible_dataset=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/inference/evaluator.html#InferenceEvaluatorConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.InferenceEvaluatorConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for running inference including comparison to reference data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Directory to save results to.</p></li>
<li><p><strong>n_forward_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of steps to run the model forward for.</p></li>
<li><p><strong>checkpoint_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to stepper checkpoint to load.</p></li>
<li><p><strong>logging</strong> (<a class="reference internal" href="#fme.ace.LoggingConfig" title="fme.core.logging_utils.LoggingConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoggingConfig</span></code></a>) – configuration for logging.</p></li>
<li><p><strong>loader</strong> (<a class="reference internal" href="#fme.ace.InferenceDataLoaderConfig" title="fme.ace.data_loading.inference.InferenceDataLoaderConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">InferenceDataLoaderConfig</span></code></a>) – Configuration for data to be used as initial conditions, forcing, and
target in inference.</p></li>
<li><p><strong>prediction_loader</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.InferenceDataLoaderConfig" title="fme.ace.data_loading.inference.InferenceDataLoaderConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">InferenceDataLoaderConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Configuration for prediction data to evaluate. If given,
model evaluation will not run, and instead predictions will be evaluated.
Model checkpoint will still be used to determine inputs and outputs.</p></li>
<li><p><strong>forward_steps_in_memory</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Number of forward steps to complete in memory
at a time, will load one more step for initial condition.</p></li>
<li><p><strong>data_writer</strong> (<a class="reference internal" href="#fme.ace.DataWriterConfig" title="fme.ace.inference.data_writer.main.DataWriterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataWriterConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Configuration for data writers.</p></li>
<li><p><strong>aggregator</strong> (<a class="reference internal" href="#fme.ace.InferenceEvaluatorAggregatorConfig" title="fme.ace.aggregator.inference.main.InferenceEvaluatorAggregatorConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">InferenceEvaluatorAggregatorConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Configuration for inference evaluator aggregator.</p></li>
<li><p><strong>stepper_override</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.StepperOverrideConfig" title="fme.ace.stepper.single_module.StepperOverrideConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepperOverrideConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Configuration for overriding select stepper configuration
options at inference time (optional).</p></li>
<li><p><strong>allow_incompatible_dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – If True, allow the forcing dataset used
for inference to be incompatible with the dataset used for stepper training.
This should be used with caution, as it may allow the stepper to make
scientifically invalid predictions, but it can allow running inference with
incorrectly formatted or missing grid information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.InferenceInitialConditionIndices">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">InferenceInitialConditionIndices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_initial_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/inference.html#InferenceInitialConditionIndices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.InferenceInitialConditionIndices" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration of the indices for initial conditions during inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_initial_conditions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of initial conditions to use.</p></li>
<li><p><strong>first</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) – Index of the first initial condition.</p></li>
<li><p><strong>interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Interval between initial conditions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.InitialConditionConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">InitialConditionConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'netcdf4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/inference/inference.html#InitialConditionConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.InitialConditionConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for initial conditions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The data specified under path should contain a time dimension of at least
length 1. If multiple times are present in the dataset specified by <code class="docutils literal notranslate"><span class="pre">path</span></code>,
the inference will start an ensemble simulation using each IC along a
leading sample dimension. Specific times can be selected from the dataset
by using <code class="docutils literal notranslate"><span class="pre">start_indices</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – The path to the initial conditions dataset.</p></li>
<li><p><strong>engine</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'netcdf4'</span></code>, <code class="docutils literal notranslate"><span class="pre">'h5netcdf'</span></code>, <code class="docutils literal notranslate"><span class="pre">'zarr'</span></code>], default: <code class="docutils literal notranslate"><span class="pre">'netcdf4'</span></code>) – The engine used to open the dataset.</p></li>
<li><p><strong>start_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/types.html#types.UnionType" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code></a>[<a class="reference internal" href="#fme.ace.InferenceInitialConditionIndices" title="fme.ace.data_loading.inference.InferenceInitialConditionIndices"><code class="xref py py-class docutils literal notranslate"><span class="pre">InferenceInitialConditionIndices</span></code></a>, <a class="reference internal" href="#fme.ace.ExplicitIndices" title="fme.ace.data_loading.inference.ExplicitIndices"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExplicitIndices</span></code></a>, <a class="reference internal" href="#fme.ace.TimestampList" title="fme.ace.data_loading.inference.TimestampList"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimestampList</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – optional specification of the subset of
initial conditions to use.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.InlineInferenceConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">InlineInferenceConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_forward_steps=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_steps_in_memory=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregator=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/train/train_config.html#InlineInferenceConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.InlineInferenceConfig" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loader</strong> (<a class="reference internal" href="#fme.ace.InferenceDataLoaderConfig" title="fme.ace.data_loading.inference.InferenceDataLoaderConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">InferenceDataLoaderConfig</span></code></a>) – configuration for the data loader used during inference</p></li>
<li><p><strong>n_forward_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">2</span></code>) – number of forward steps to take</p></li>
<li><p><strong>forward_steps_in_memory</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">2</span></code>) – number of forward steps to take before
re-reading data from disk</p></li>
<li><p><strong>epochs</strong> (<a class="reference internal" href="#fme.ace.Slice" title="fme.core.typing_.Slice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Slice</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – epochs on which to run inference. By default runs inference every epoch.</p></li>
<li><p><strong>aggregator</strong> (<a class="reference internal" href="#fme.ace.InferenceEvaluatorAggregatorConfig" title="fme.ace.aggregator.inference.main.InferenceEvaluatorAggregatorConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">InferenceEvaluatorAggregatorConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – configuration of inline inference aggregator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.LoggingConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">LoggingConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">project</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ace'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ai2cm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_to_screen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_to_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_to_wandb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%(asctime)s</span> <span class="pre">-</span> <span class="pre">%(name)s</span> <span class="pre">-</span> <span class="pre">%(levelname)s</span> <span class="pre">-</span> <span class="pre">%(message)s'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_dir_in_experiment_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/logging_utils.html#LoggingConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.LoggingConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for logging.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>project</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">'ace'</span></code>) – Name of the project in Weights &amp; Biases.</p></li>
<li><p><strong>entity</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">'ai2cm'</span></code>) – Name of the entity in Weights &amp; Biases.</p></li>
<li><p><strong>log_to_screen</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to log to the screen.</p></li>
<li><p><strong>log_to_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to log to a file.</p></li>
<li><p><strong>log_to_wandb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to log to Weights &amp; Biases.</p></li>
<li><p><strong>log_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">'%(asctime)s</span> <span class="pre">-</span> <span class="pre">%(name)s</span> <span class="pre">-</span> <span class="pre">%(levelname)s</span> <span class="pre">-</span> <span class="pre">%(message)s'</span></code>) – Format of the log messages.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">20</span></code>) – Sets the logging level.</p></li>
<li><p><strong>wandb_dir_in_experiment_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to create the wandb_dir in the
experiment_dir or in local /tmp (default False).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.LoggingConfig.configure_logging">
<span class="sig-name descname"><span class="pre">configure_logging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/logging_utils.html#LoggingConfig.configure_logging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.LoggingConfig.configure_logging" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the global <cite>logging</cite> module based on this LoggingConfig.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>log_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.MergeDatasetConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">MergeDatasetConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">merge</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/dataset/config.html#MergeDatasetConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.MergeDatasetConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for merging multiple datasets.
:type merge: <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference internal" href="#fme.ace.ConcatDatasetConfig" title="fme.core.dataset.config.ConcatDatasetConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConcatDatasetConfig</span></code></a> | <a class="reference internal" href="#fme.ace.XarrayDataConfig" title="fme.core.dataset.config.XarrayDataConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">XarrayDataConfig</span></code></a>]
:param merge: List of ConcatDatasetConfig or XarrayDataConfig to merge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>merge</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference internal" href="#fme.ace.ConcatDatasetConfig" title="fme.core.dataset.config.ConcatDatasetConfig"><em>ConcatDatasetConfig</em></a><em> | </em><a class="reference internal" href="#fme.ace.XarrayDataConfig" title="fme.core.dataset.config.XarrayDataConfig"><em>XarrayDataConfig</em></a><em>]</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.MergeNoConcatDatasetConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">MergeNoConcatDatasetConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">merge</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/dataset/config.html#MergeNoConcatDatasetConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.MergeNoConcatDatasetConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for merging multiple datasets. No concatenation is allowed.
:type merge: <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference internal" href="#fme.ace.XarrayDataConfig" title="fme.core.dataset.config.XarrayDataConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">XarrayDataConfig</span></code></a>]
:param merge: List of XarrayDataConfig to merge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>merge</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference internal" href="#fme.ace.XarrayDataConfig" title="fme.core.dataset.config.XarrayDataConfig"><em>XarrayDataConfig</em></a><em>]</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.ModuleSelector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">ModuleSelector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/registry/module.html#ModuleSelector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ModuleSelector" title="Permalink to this definition">¶</a></dt>
<dd><p>A dataclass containing all the information needed to build a ModuleConfig,
including the type of the ModuleConfig and the data needed to build it.</p>
<p>This is helpful as ModuleSelector can be serialized and deserialized
without any additional information, whereas to load a ModuleConfig you
would need to know the type of the ModuleConfig being loaded.</p>
<p>It is also convenient because ModuleSelector is a single class that can be
used to represent any ModuleConfig, whereas ModuleConfig is a protocol
that can be implemented by many different classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the type of the ModuleConfig</p></li>
<li><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – data for a ModuleConfig instance of the indicated type</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.ModuleSelector.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/registry/module.html#ModuleSelector.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ModuleSelector.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a nn.Module given information about the input and output channels
and the image shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of input channels</p></li>
<li><p><strong>n_out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of output channels</p></li>
<li><p><strong>img_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – shape of last two dimensions of data, e.g. latitude and
longitude.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.ModuleSelector.get_available_types">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_available_types</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/registry/module.html#ModuleSelector.get_available_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ModuleSelector.get_available_types" title="Permalink to this definition">¶</a></dt>
<dd><p>This class method is used to expose all available types of Modules.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.MultiCallConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">MultiCallConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forcing_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forcing_multipliers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/multi_call.html#MultiCallConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.MultiCallConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for doing ‘multi-call’ predictions where an input variable (e.g.
CO2) is varied by multiplying by floats and then certain output variables (e.g.
radiative heating or fluxes) are predicted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>forcing_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – name of the variable to perturb in the forcing data, e.g. “co2”.</p></li>
<li><p><strong>forcing_multipliers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]) – mapping from a label suffix to a multiplier that is applied
to the ‘forcing_name’ variable. For example, could be
{“_quadrupled_co2”: 4, “_halved_co2”: 0.5}. The suffixes will be appended to
the output_names below.</p></li>
<li><p><strong>output_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – names of the variables to predict given perturbed forcing. For
example, [“ULWRFtoa”, “USWRFsfc”].</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.MultiCallConfig.names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fme.ace.MultiCallConfig.names" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the names of all multi-called output variables,
often radiative fluxes.</p>
<p>E.g. [‘ULWRFtoa_quadrupled_co2’].</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.NormalizationConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">NormalizationConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_means_path=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_stds_path=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">means=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stds=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_nans_on_normalize=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_nans_on_denormalize=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/normalizer.html#NormalizationConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.NormalizationConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for normalizing data.</p>
<p>Either global_means_path and global_stds_path or explicit means and stds
must be provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>global_means_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/types.html#types.UnionType" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Path to a netCDF file containing global means.</p></li>
<li><p><strong>global_stds_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/types.html#types.UnionType" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnionType</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Path to a netCDF file containing global stds.</p></li>
<li><p><strong>means</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Mapping from variable names to means.</p></li>
<li><p><strong>stds</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Mapping from variable names to stds.</p></li>
<li><p><strong>fill_nans_on_normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to fill NaNs during normalization. If
true, on normalization NaNs in the denormalized input become zeros in
the normalized output.</p></li>
<li><p><strong>fill_nans_on_denormalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to fill NaNs during denormalization. If
true, on denormalization NaNs in the normalized input become global means in
the denormalized output.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.NormalizationConfig.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/normalizer.html#NormalizationConfig.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.NormalizationConfig.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the normalization configuration from the netCDF files.</p>
<p>Updates the configuration so it no longer requires external files.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.OceanConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">OceanConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surface_temperature_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocean_fraction_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/ocean.html#OceanConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.OceanConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for determining sea surface temperature from an ocean model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surface_temperature_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the sea surface temperature field.</p></li>
<li><p><strong>ocean_fraction_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the ocean fraction field.</p></li>
<li><p><strong>interpolate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – If True, interpolate between ML-predicted surface temperature and
ocean-predicted surface temperature according to ocean_fraction. If False,
only use ocean-predicted surface temperature where ocean_fraction&gt;=0.5.</p></li>
<li><p><strong>slab</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.SlabOceanConfig" title="fme.core.ocean.SlabOceanConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SlabOceanConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – If provided, use a slab ocean model to predict surface temperature.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.OceanCorrectorConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">OceanCorrectorConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_positive_names=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sea_ice_fraction_correction=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masking=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocean_heat_content_correction=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/corrector/ocean.html#OceanCorrectorConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.OceanCorrectorConfig" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force_positive_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>sea_ice_fraction_correction</strong> (<em>SeaIceFractionConfig</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>masking</strong> (<em>StaticMaskingConfig</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>ocean_heat_content_correction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.OneStepAggregatorConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">OneStepAggregatorConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_snapshots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_mean_maps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/aggregator/one_step/main.html#OneStepAggregatorConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.OneStepAggregatorConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the validation OneStepAggregator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_snapshots</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to log snapshot images.</p></li>
<li><p><strong>log_mean_maps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to log mean map images.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.OptimizationConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">OptimizationConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer_type='Adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr=0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_automatic_mixed_precision=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gradient_accumulation=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/optimization.html#OptimizationConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.OptimizationConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'Adam'</span></code>, <code class="docutils literal notranslate"><span class="pre">'FusedAdam'</span></code>], default: <code class="docutils literal notranslate"><span class="pre">'Adam'</span></code>) – The type of optimizer to use.</p></li>
<li><p><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0.001</span></code>) – The learning rate.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Additional keyword arguments to pass to the optimizer.</p></li>
<li><p><strong>enable_automatic_mixed_precision</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to use automatic mixed
precision.</p></li>
<li><p><strong>scheduler</strong> (<a class="reference internal" href="#fme.ace.SchedulerConfig" title="fme.core.scheduler.SchedulerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchedulerConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – The type of scheduler to use. If none is given, no scheduler
will be used.</p></li>
<li><p><strong>use_gradient_accumulation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to use gradient accumulation. This must be
supported by the stepper being optimized, which may accumulate gradients
from separate losses to reduce memory consumption. The stepper may choose
to accumulate gradients differently when this is enabled, such as by
detaching the computational graph between steps. See the documentation of
your stepper (e.g. Stepper) for more details.</p></li>
<li><p><strong>checkpoint</strong> (<em>CheckpointConfig</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.OverwriteConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">OverwriteConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">constant=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiply_scalar=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/dataset/config.html#OverwriteConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.OverwriteConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration to overwrite field values in XarrayDataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>constant</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Fill field with constant value.</p></li>
<li><p><strong>multiply_scalar</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Multiply field by scalar value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.ParameterInitializationConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">ParameterInitializationConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights_path=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_parameters=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen_parameters=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/parameter_init.html#ParameterInitializationConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ParameterInitializationConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>A class which applies custom initialization to module parameters.</p>
<p>Assumes the module weights have already been randomly initialized.</p>
<p>Supports overwriting the weights of the built model with weights from a
pre-trained model. If the built model has larger weights than the
pre-trained model, only the initial slice of the weights is overwritten.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weight_path</strong> – path to a Stepper checkpoint
containing weights to load</p></li>
<li><p><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterClassification</span></code>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – list of ParameterClassification objects, each specifying
whether parameters are excluded from initialization or frozen.
By default modules are unfrozen and all parameters are included.
Must be provided in the same order as provided by the stepper’s
<cite>.modules</cite> attribute.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0.0</span></code>) – L2 regularization coefficient keeping initialized weights
close to their intiial values</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">0.0</span></code>) – L2 regularization coefficient keeping uninitialized weights
close to zero</p></li>
<li><p><strong>exclude_parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – deprecated, kept for backwards compatibility</p></li>
<li><p><strong>frozen_parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.FrozenParameterConfig" title="fme.ace.stepper.parameter_init.FrozenParameterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenParameterConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – deprecated, kept for backwards compatibility</p></li>
<li><p><strong>weights_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.ParameterInitializationConfig.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">load_weights_and_history</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/parameter_init.html#ParameterInitializationConfig.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.ParameterInitializationConfig.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a ParameterInitializer instance with the current configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>load_weights_and_history</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingHistory</span></code>]]) – a function which loads weights and training
history from a path, specifically the configured weights_path.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterInitializer</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.PerturbationSelector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">PerturbationSelector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/perturbation.html#PerturbationSelector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.PerturbationSelector" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><em>Mapping</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.PerturbationSelector.get_available_types">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_available_types</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/perturbation.html#PerturbationSelector.get_available_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.PerturbationSelector.get_available_types" title="Permalink to this definition">¶</a></dt>
<dd><p>This class method is used to expose all available types of Perturbations.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.RecurrentBlockConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">RecurrentBlockConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_nhwc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_healpixpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ConvGRUBlock'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_blocks.html#RecurrentBlockConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.RecurrentBlockConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the recurrent block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">3</span></code>) – Number of input channels, default is 3.</p></li>
<li><p><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Size of the kernel, default is 1.</p></li>
<li><p><strong>enable_nhwc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable NHWC data format, default is False.</p></li>
<li><p><strong>enable_healpixpad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable HEALPix padding, default is False.</p></li>
<li><p><strong>block_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'ConvGRUBlock'</span></code>, <code class="docutils literal notranslate"><span class="pre">'ConvLSTMBlock'</span></code>], default: <code class="docutils literal notranslate"><span class="pre">'ConvGRUBlock'</span></code>) – Type of recurrent block, either “ConvGRUBlock” or “ConvLSTMBlock”,</p></li>
<li><p><strong>&quot;ConvGRUBlock&quot;.</strong> (<em>default is</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.RecurrentBlockConfig.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_blocks.html#RecurrentBlockConfig.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.RecurrentBlockConfig.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the recurrent block model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Recurrent block.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.RepeatedInterval">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">RepeatedInterval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/dataset/config.html#RepeatedInterval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.RepeatedInterval" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for a repeated interval within a block.  This configuration
is used to generate a boolean mask for a dataset that will return values
within the interval and repeat that throughout the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interval_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Length of the interval to return values from</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Start position of the interval within the repeat block.</p></li>
<li><p><strong>block_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Total length of the block to be repeated over the length of
the dataset, including the interval length.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The interval_length, start, and block_length can be provided as either
all integers or all strings representing timedeltas of the block.
If provided as strings, the timestep must be provided when calling
<cite>get_boolean_mask</cite>.</p>
</div>
<p class="rubric">Examples</p>
<p>To return values from the first 3 items of every 6 items, use:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fme</span><span class="o">.</span><span class="n">ace</span><span class="o">.</span><span class="n">RepeatedInterval</span><span class="p">(</span><span class="n">interval_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">block_length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  
</pre></div>
</div>
<p>To return a days worth of values starting after 2 days from every 7-day
block, use:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fme</span><span class="o">.</span><span class="n">ace</span><span class="o">.</span><span class="n">RepeatedInterval</span><span class="p">(</span><span class="n">interval_length</span><span class="o">=</span><span class="s2">&quot;1d&quot;</span><span class="p">,</span> <span class="n">block_length</span><span class="o">=</span><span class="s2">&quot;7d&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2d&quot;</span><span class="p">)</span>  
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.RepeatedInterval.get_boolean_mask">
<span class="sig-name descname"><span class="pre">get_boolean_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/dataset/config.html#RepeatedInterval.get_boolean_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.RepeatedInterval.get_boolean_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a boolean mask for the repeated interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Length of the dataset.</p></li>
<li><p><strong>timestep</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">timedelta</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Timestep of the dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.SFNO_V0_1_0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">SFNO_V0_1_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectral_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sht'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dhconv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_thresholding_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'instance_norm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'direct'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">big_skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factorization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complex_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'real'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpointing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'legendre-gauss'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/registry/sfno.html#SFNO_V0_1_0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SFNO_V0_1_0" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the SFNO architecture in modulus-makani version 0.1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectral_transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>filter_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'linear'</em><em>]</em>) – </p></li>
<li><p><strong>operator_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>embed_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>repeat_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>hard_thresholding_fraction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – </p></li>
<li><p><strong>normalization_layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>use_mlp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
<li><p><strong>activation_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>encoder_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>pos_embed</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'none'</em><em>, </em><em>'direct'</em><em>, </em><em>'frequency'</em><em>]</em>) – </p></li>
<li><p><strong>big_skip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
<li><p><strong>rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – </p></li>
<li><p><strong>factorization</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>separable</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
<li><p><strong>complex_activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>spectral_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>checkpointing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>data_grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'legendre-gauss'</em><em>, </em><em>'equiangular'</em><em>, </em><em>'healpix'</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.SFNO_V0_1_0.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/registry/sfno.html#SFNO_V0_1_0.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SFNO_V0_1_0.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a nn.Module given information about the input and output channels
and the image shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of input channels</p></li>
<li><p><strong>n_out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of output channels</p></li>
<li><p><strong>img_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – shape of last two dimensions of data, e.g. latitude and
longitude.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a nn.Module</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.SSTPerturbation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">SSTPerturbation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/perturbation.html#SSTPerturbation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SSTPerturbation" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for sea surface temperature perturbations
applied to initial condition and forcing data.
Currently, this is strictly applied to both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference internal" href="#fme.ace.PerturbationSelector" title="fme.ace.data_loading.perturbation.PerturbationSelector"><code class="xref py py-class docutils literal notranslate"><span class="pre">PerturbationSelector</span></code></a>]) – List of perturbation selectors for SST perturbations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.SchedulerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">SchedulerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/scheduler.html#SchedulerConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SchedulerConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for a scheduler to use during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Name of scheduler class from torch.optim.lr_scheduler,
no scheduler is used by default.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Keyword arguments to pass to the scheduler constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.SchedulerConfig.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/scheduler.html#SchedulerConfig.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SchedulerConfig.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the scheduler.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">_LRScheduler</span></code>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.SingleModuleStepperConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">SingleModuleStepperConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">builder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameter_init=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocean=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrector=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_step_forcing_names=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_normalization=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_normalization=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_call=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_multi_call_in_loss=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crps_training=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_prediction=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#SingleModuleStepperConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SingleModuleStepperConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for a single module stepper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>builder</strong> (<a class="reference internal" href="#fme.ace.ModuleSelector" title="fme.core.registry.module.ModuleSelector"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleSelector</span></code></a>) – The module builder.</p></li>
<li><p><strong>in_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – Names of input variables.</p></li>
<li><p><strong>out_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – Names of output variables.</p></li>
<li><p><strong>normalization</strong> (<a class="reference internal" href="#fme.ace.NormalizationConfig" title="fme.core.normalizer.NormalizationConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalizationConfig</span></code></a>) – The normalization configuration.</p></li>
<li><p><strong>parameter_init</strong> (<a class="reference internal" href="#fme.ace.ParameterInitializationConfig" title="fme.ace.stepper.parameter_init.ParameterInitializationConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterInitializationConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – The parameter initialization configuration.</p></li>
<li><p><strong>ocean</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.OceanConfig" title="fme.core.ocean.OceanConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">OceanConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – The ocean configuration.</p></li>
<li><p><strong>loss</strong> (<a class="reference internal" href="#fme.ace.WeightedMappingLossConfig" title="fme.core.loss.WeightedMappingLossConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeightedMappingLossConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – The loss configuration.</p></li>
<li><p><strong>corrector</strong> (<a class="reference internal" href="#fme.ace.AtmosphereCorrectorConfig" title="fme.core.corrector.atmosphere.AtmosphereCorrectorConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtmosphereCorrectorConfig</span></code></a> | <a class="reference internal" href="#fme.ace.CorrectorSelector" title="fme.core.registry.corrector.CorrectorSelector"><code class="xref py py-class docutils literal notranslate"><span class="pre">CorrectorSelector</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – The corrector configuration.</p></li>
<li><p><strong>next_step_forcing_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Names of forcing variables for the next timestep.</p></li>
<li><p><strong>loss_normalization</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.NormalizationConfig" title="fme.core.normalizer.NormalizationConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalizationConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – The normalization configuration for the loss.</p></li>
<li><p><strong>residual_normalization</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.NormalizationConfig" title="fme.core.normalizer.NormalizationConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalizationConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Optional alternative to configure loss normalization.
If provided, it will be used for all <em>prognostic</em> variables in loss scaling.</p></li>
<li><p><strong>multi_call</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.MultiCallConfig" title="fme.core.multi_call.MultiCallConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiCallConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – The configuration of multi-called diagnostics.</p></li>
<li><p><strong>include_multi_call_in_loss</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to include multi-call diagnostics in the
loss. The same loss configuration as specified in ‘loss’ is used.</p></li>
<li><p><strong>crps_training</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to use CRPS training for stochastic models.</p></li>
<li><p><strong>residual_prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to have ML module predict tendencies for
prognostic variables.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.SingleModuleStepperConfig.all_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_names</span></span><a class="headerlink" href="#fme.ace.SingleModuleStepperConfig.all_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of all variables required, including auxiliary ones.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.SingleModuleStepperConfig.diagnostic_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diagnostic_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fme.ace.SingleModuleStepperConfig.diagnostic_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of variables which are outputs only.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.SingleModuleStepperConfig.get_parameter_initializer">
<span class="sig-name descname"><span class="pre">get_parameter_initializer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#SingleModuleStepperConfig.get_parameter_initializer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SingleModuleStepperConfig.get_parameter_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parameter initializer for this stepper configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterInitializer</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.SingleModuleStepperConfig.get_stepper">
<span class="sig-name descname"><span class="pre">get_stepper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_parameter_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#SingleModuleStepperConfig.get_stepper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SingleModuleStepperConfig.get_stepper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_info</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetInfo</span></code>) – Information about the training dataset.</p></li>
<li><p><strong>apply_parameter_init</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to apply parameter initialization.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stepper</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.SingleModuleStepperConfig.input_only_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_only_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fme.ace.SingleModuleStepperConfig.input_only_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of variables which are inputs only.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.SingleModuleStepperConfig.normalize_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalize_names</span></span><a class="headerlink" href="#fme.ace.SingleModuleStepperConfig.normalize_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of variables which require normalization. I.e. inputs/outputs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.SingleModuleStepperConfig.prognostic_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prognostic_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fme.ace.SingleModuleStepperConfig.prognostic_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of variables which both inputs and outputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.SingleModuleStepperConfig.to_stepper_config">
<span class="sig-name descname"><span class="pre">to_stepper_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_normalizer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#SingleModuleStepperConfig.to_stepper_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SingleModuleStepperConfig.to_stepper_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the current config to a stepper config.</p>
<p>Overwriting normalization configuration is needed to avoid
a checkpoint trying to load normalization data from netCDF files
which are no longer present when running inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalizer</strong> (<a class="reference internal" href="#fme.StandardNormalizer" title="fme.core.normalizer.StandardNormalizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">StandardNormalizer</span></code></a>) – overwrite the normalization config
with data from this normalizer</p></li>
<li><p><strong>loss_normalizer</strong> (<a class="reference internal" href="#fme.StandardNormalizer" title="fme.core.normalizer.StandardNormalizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">StandardNormalizer</span></code></a>) – overwrite the loss normalization config
with data from this normalizer</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#fme.ace.StepperConfig" title="fme.ace.stepper.single_module.StepperConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepperConfig</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A stepper config.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.SlabOceanConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">SlabOceanConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixed_layer_depth_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_flux_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/ocean.html#SlabOceanConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SlabOceanConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for a slab ocean model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mixed_layer_depth_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the mixed layer depth field.</p></li>
<li><p><strong>q_flux_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the heat flux field.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.Slice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">Slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/typing_.html#Slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.Slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration of a python <cite>slice</cite> built-in.</p>
<p>Required because <cite>slice</cite> cannot be initialized directly by dacite.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Start index of the slice.</p></li>
<li><p><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Stop index of the slice.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Step of the slice.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.SphericalFourierNeuralOperatorBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">SphericalFourierNeuralOperatorBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectral_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sht'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'diagonal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_filter_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard_thresholding_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'instance_norm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">big_skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factorization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complex_network</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complex_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'real'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpointing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'legendre-gauss'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/registry/sfno.html#SphericalFourierNeuralOperatorBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SphericalFourierNeuralOperatorBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the SFNO architecture used in FourCastNet-SFNO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectral_transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>filter_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>operator_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>residual_filter_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>embed_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>hard_thresholding_fraction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – </p></li>
<li><p><strong>normalization_layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>use_mlp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
<li><p><strong>activation_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>encoder_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>pos_embed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
<li><p><strong>big_skip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
<li><p><strong>rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – </p></li>
<li><p><strong>factorization</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>separable</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
<li><p><strong>complex_network</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
<li><p><strong>complex_activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>spectral_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>checkpointing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>data_grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'legendre-gauss'</em><em>, </em><em>'equiangular'</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.SphericalFourierNeuralOperatorBuilder.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/registry/sfno.html#SphericalFourierNeuralOperatorBuilder.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.SphericalFourierNeuralOperatorBuilder.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a nn.Module given information about the input and output channels
and the image shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of input channels</p></li>
<li><p><strong>n_out_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of output channels</p></li>
<li><p><strong>img_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – shape of last two dimensions of data, e.g. latitude and
longitude.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a nn.Module</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.StepperConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">StepperConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ensemble=-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crps_training=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameter_init=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_masking=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#StepperConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.StepperConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for a stepper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">StepSelector</span></code>) – The step configuration.</p></li>
<li><p><strong>loss</strong> (<a class="reference internal" href="#fme.ace.WeightedMappingLossConfig" title="fme.core.loss.WeightedMappingLossConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeightedMappingLossConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – The loss configuration.</p></li>
<li><p><strong>n_ensemble</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">-1</span></code>) – The number of ensemble members evaluated for each training
batch member. Default is 2 if the loss type is EnsembleLoss, otherwise
the default is 1. Must be 2 for EnsembleLoss to be valid.</p></li>
<li><p><strong>crps_training</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Deprecated, kept for backwards compatibility. Use
n_ensemble=2 with a CRPS loss instead.</p></li>
<li><p><strong>parameter_init</strong> (<a class="reference internal" href="#fme.ace.ParameterInitializationConfig" title="fme.ace.stepper.parameter_init.ParameterInitializationConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterInitializationConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – The parameter initialization configuration.</p></li>
<li><p><strong>input_masking</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">StaticMaskingConfig</span></code>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Config for masking step inputs.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.StepperConfig.all_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fme.ace.StepperConfig.all_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of all variables.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.StepperConfig.from_stepper_state">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_stepper_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#StepperConfig.from_stepper_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.StepperConfig.from_stepper_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a StepperConfig from a stepper state.</p>
<p>This is required for backwards compatibility with older steppers,
whose configuration did not provide normalization constants, but rather
pointed to files on disk. Newer stepper configurations load these
constants into the configuration before checkpoints are saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> – The state of the stepper.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#fme.ace.StepperConfig" title="fme.ace.stepper.single_module.StepperConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepperConfig</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The stepper config.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.StepperConfig.get_parameter_initializer">
<span class="sig-name descname"><span class="pre">get_parameter_initializer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#StepperConfig.get_parameter_initializer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.StepperConfig.get_parameter_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parameter initializer for this stepper configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterInitializer</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.StepperConfig.get_stepper">
<span class="sig-name descname"><span class="pre">get_stepper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_parameter_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#StepperConfig.get_stepper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.StepperConfig.get_stepper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_info</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetInfo</span></code>) – Information about the training dataset.</p></li>
<li><p><strong>apply_parameter_init</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to apply parameter initialization.</p></li>
<li><p><strong>training_history</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingHistory</span></code>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – History of the stepper’s training jobs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.StepperConfig.input_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fme.ace.StepperConfig.input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of variables which are required as inputs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.StepperConfig.loss_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loss_names</span></span><a class="headerlink" href="#fme.ace.StepperConfig.loss_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of variables to include in loss.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.StepperConfig.next_step_forcing_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">next_step_forcing_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fme.ace.StepperConfig.next_step_forcing_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of variables which are given as inputs but taken from the output timestep.</p>
<p>An example might be solar insolation taken during the output window period.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.StepperConfig.output_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fme.ace.StepperConfig.output_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of variables which are outputs only.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.StepperConfig.prognostic_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prognostic_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fme.ace.StepperConfig.prognostic_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of variables which both inputs and outputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.StepperConfig.replace_multi_call">
<span class="sig-name descname"><span class="pre">replace_multi_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multi_call</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#StepperConfig.replace_multi_call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.StepperConfig.replace_multi_call" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the multi-call configuration of self.step and ensure the
associated state can be loaded as a multi-call step.</p>
<p>A value of <cite>None</cite> for <cite>multi_call</cite> will remove the multi-call configuration.</p>
<p>If the selected type supports it, the multi-call configuration will be
updated in place. Otherwise, it will be wrapped in the multi_call step
configuration with the given multi_call config or None.</p>
<p>Note this updates self.step in place, but returns a new state dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multi_call</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.MultiCallConfig" title="fme.core.multi_call.MultiCallConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiCallConfig</span></code></a>]) – MultiCallConfig for the resulting self.step.</p></li>
<li><p><strong>state</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – state dictionary associated with the loaded step.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The state dictionary updated to ensure consistency with that of a
serialized multi-call step.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.StepperOverrideConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">StepperOverrideConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ocean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'keep'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_call</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'keep'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/stepper/single_module.html#StepperOverrideConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.StepperOverrideConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for overriding stepper configuration options.</p>
<p>The default value for each parameter is <code class="docutils literal notranslate"><span class="pre">&quot;keep&quot;</span></code>, which denotes that the
serialized stepper’s configuration will not be modified when loaded. Passing
other values will override the configuration of the loaded stepper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ocean</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'keep'</span></code>], <a class="reference internal" href="#fme.ace.OceanConfig" title="fme.core.ocean.OceanConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">OceanConfig</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">'keep'</span></code>) – Ocean configuration to override that used in producing a serialized
stepper.</p></li>
<li><p><strong>multi_call</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'keep'</span></code>], <a class="reference internal" href="#fme.ace.MultiCallConfig" title="fme.core.multi_call.MultiCallConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiCallConfig</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">'keep'</span></code>) – MultiCall configuration to override that used in producing a
serialized stepper.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.TimeCoarsenConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">TimeCoarsenConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coarsen_factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/inference/data_writer/time_coarsen.html#TimeCoarsenConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.TimeCoarsenConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Config for inference data time coarsening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coarsen_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Factor by which to coarsen in time, an integer 1 or greater. The
resulting time labels will be coarsened to the mean of the original labels.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.TimeCoarsenConfig.n_coarsened_timesteps">
<span class="sig-name descname"><span class="pre">n_coarsened_timesteps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_timesteps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/inference/data_writer/time_coarsen.html#TimeCoarsenConfig.n_coarsened_timesteps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.TimeCoarsenConfig.n_coarsened_timesteps" title="Permalink to this definition">¶</a></dt>
<dd><p>Assumes initial condition is NOT in n_timesteps.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>n_timesteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.TimeSlice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">TimeSlice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/dataset/config.html#TimeSlice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.TimeSlice" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration of a slice of times. Step is an integer-valued index step.</p>
<dl class="simple">
<dt>Note: start_time and stop_time may be provided as partial time strings and the</dt><dd><p>stop_time will be included in the slice. See more details in <a class="reference external" href="https://docs.xarray.dev/en/latest/user-guide/weather-climate.html#non-standard-calendars-and-dates-outside-the-nanosecond-precision-range">Xarray docs</a>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Start time of the slice.</p></li>
<li><p><strong>stop_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Stop time of the slice.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Step of the slice.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.TimestampList">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">TimestampList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%Y-%m-%dT%H:%M:%S'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/data_loading/inference.html#TimestampList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.TimestampList" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for a list of timestamps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>times</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – List of timestamps.</p></li>
<li><p><strong>timestamp_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">'%Y-%m-%dT%H:%M:%S'</span></code>) – Format of the timestamps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.TrainConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">TrainConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_forward_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_weights_after_batch=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ema=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weather_evaluation=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate_using_ema=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_save_epochs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ema_checkpoint_save_epochs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_train_every_n_batches=100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segment_epochs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_per_epoch_diagnostics=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_aggregator=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_before_training=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/train/train_config.html#TrainConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.TrainConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for training a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loader</strong> (<a class="reference internal" href="#fme.ace.DataLoaderConfig" title="fme.ace.data_loading.config.DataLoaderConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoaderConfig</span></code></a>) – Configuration for the training data loader.</p></li>
<li><p><strong>validation_loader</strong> (<a class="reference internal" href="#fme.ace.DataLoaderConfig" title="fme.ace.data_loading.config.DataLoaderConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoaderConfig</span></code></a>) – Configuration for the validation data loader.</p></li>
<li><p><strong>stepper</strong> (<a class="reference internal" href="#fme.ace.SingleModuleStepperConfig" title="fme.ace.stepper.single_module.SingleModuleStepperConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingleModuleStepperConfig</span></code></a> | <a class="reference internal" href="#fme.ace.ExistingStepperConfig" title="fme.ace.stepper.single_module.ExistingStepperConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExistingStepperConfig</span></code></a> | <a class="reference internal" href="#fme.ace.StepperConfig" title="fme.ace.stepper.single_module.StepperConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepperConfig</span></code></a>) – Configuration for the stepper. SingleModuleStepperConfig is
deprecated and will be removed in a future version. Use StepperConfig
instead.</p></li>
<li><p><strong>optimization</strong> (<a class="reference internal" href="#fme.ace.OptimizationConfig" title="fme.core.optimization.OptimizationConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizationConfig</span></code></a>) – Configuration for the optimization.</p></li>
<li><p><strong>logging</strong> (<a class="reference internal" href="#fme.ace.LoggingConfig" title="fme.core.logging_utils.LoggingConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoggingConfig</span></code></a>) – Configuration for logging.</p></li>
<li><p><strong>max_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Total number of epochs to train for.</p></li>
<li><p><strong>save_checkpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether to save checkpoints.</p></li>
<li><p><strong>experiment_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Directory where checkpoints and logs are saved.</p></li>
<li><p><strong>inference</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.InlineInferenceConfig" title="fme.ace.train.train_config.InlineInferenceConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">InlineInferenceConfig</span></code></a>]) – Configuration for inline inference.
If None, no inline inference is run,
and no “best_inline_inference” checkpoint will be saved.</p></li>
<li><p><strong>weather_evaluation</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">WeatherEvaluationConfig</span></code>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Configuration for weather evaluation.
If None, no weather evaluation is run. Weather evaluation is not
used to select checkpoints, but is used to provide metrics.</p></li>
<li><p><strong>n_forward_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of forward steps to take gradient over.</p></li>
<li><p><strong>copy_weights_after_batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference internal" href="#fme.ace.CopyWeightsConfig" title="fme.core.weight_ops.CopyWeightsConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">CopyWeightsConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Configuration for copying weights from the
base model to the training model after each batch.</p></li>
<li><p><strong>ema</strong> (<a class="reference internal" href="#fme.ace.EMAConfig" title="fme.core.ema.EMAConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">EMAConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Configuration for exponential moving average of model weights.</p></li>
<li><p><strong>validate_using_ema</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to validate and perform inference using
the EMA model.</p></li>
<li><p><strong>checkpoint_save_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.Slice" title="fme.core.typing_.Slice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Slice</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – How often to save epoch-based checkpoints,
if save_checkpoint is True. If None, checkpoints are only saved
for the most recent epoch
(and the best epochs if validate_using_ema == False).</p></li>
<li><p><strong>ema_checkpoint_save_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.Slice" title="fme.core.typing_.Slice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Slice</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – How often to save epoch-based EMA checkpoints,
if save_checkpoint is True. If None, EMA checkpoints are only saved
for the most recent epoch
(and the best epochs if validate_using_ema == True).</p></li>
<li><p><strong>log_train_every_n_batches</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">100</span></code>) – How often to log batch_loss during training.</p></li>
<li><p><strong>segment_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Exit after training for at most this many epochs
in current job, without exceeding <cite>max_epochs</cite>. Use this if training
must be run in segments, e.g. due to wall clock limit.</p></li>
<li><p><strong>save_per_epoch_diagnostics</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to save per-epoch diagnostics from
training, validation and inline inference aggregators.</p></li>
<li><p><strong>validation_aggregator</strong> (<a class="reference internal" href="#fme.ace.OneStepAggregatorConfig" title="fme.ace.aggregator.one_step.main.OneStepAggregatorConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneStepAggregatorConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Configuration for the validation aggregator.</p></li>
<li><p><strong>evaluate_before_training</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to run validation and inline inference before
any training is done.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.TrainConfig.checkpoint_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">checkpoint_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#fme.ace.TrainConfig.checkpoint_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>The directory where checkpoints are saved.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fme.ace.TrainConfig.output_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#fme.ace.TrainConfig.output_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>The directory where output files are saved.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.UNetDecoderConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">UNetDecoderConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conv_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_sampling_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurrent_block=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_channels=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilations=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_nhwc=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_healpixpad=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_decoder.html#UNetDecoderConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.UNetDecoderConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the UNet Decoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conv_block</strong> (<a class="reference internal" href="#fme.ace.ConvBlockConfig" title="fme.ace.models.healpix.healpix_blocks.ConvBlockConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvBlockConfig</span></code></a>) – Configuration for the convolutional block.</p></li>
<li><p><strong>up_sampling_block</strong> (<a class="reference internal" href="#fme.ace.ConvBlockConfig" title="fme.ace.models.healpix.healpix_blocks.ConvBlockConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvBlockConfig</span></code></a>) – Configuration for the up-sampling block.</p></li>
<li><p><strong>output_layer</strong> (<a class="reference internal" href="#fme.ace.ConvBlockConfig" title="fme.ace.models.healpix.healpix_blocks.ConvBlockConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvBlockConfig</span></code></a>) – Configuration for the output layer block.</p></li>
<li><p><strong>recurrent_block</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.RecurrentBlockConfig" title="fme.ace.models.healpix.healpix_blocks.RecurrentBlockConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">RecurrentBlockConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Configuration for the recurrent block, by default None.</p></li>
<li><p><strong>n_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Number of channels for each layer, by default (34, 68, 136).</p></li>
<li><p><strong>n_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Number of layers in each block, by default (1, 2, 2).</p></li>
<li><p><strong>output_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Number of output channels, by default 1.</p></li>
<li><p><strong>dilations</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – List of dilation rates for the layers, by default None.</p></li>
<li><p><strong>enable_nhwc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable NHWC data format, by default False.</p></li>
<li><p><strong>enable_healpixpad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable HEALPix padding, by default False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.UNetDecoderConfig.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_decoder.html#UNetDecoderConfig.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.UNetDecoderConfig.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the UNet Decoder model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>UNet Decoder model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.UNetEncoderConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">UNetEncoderConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conv_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">down_sampling_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_channels=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_channels=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilations=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_nhwc=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_healpixpad=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_encoder.html#UNetEncoderConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.UNetEncoderConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for the UNet Encoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conv_block</strong> (<a class="reference internal" href="#fme.ace.ConvBlockConfig" title="fme.ace.models.healpix.healpix_blocks.ConvBlockConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvBlockConfig</span></code></a>) – Configuration for the convolutional block.</p></li>
<li><p><strong>down_sampling_block</strong> (<a class="reference internal" href="#fme.ace.DownsamplingBlockConfig" title="fme.ace.models.healpix.healpix_activations.DownsamplingBlockConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DownsamplingBlockConfig</span></code></a>) – Configuration for the down-sampling block.</p></li>
<li><p><strong>input_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">3</span></code>) – Number of input channels, by default 3.</p></li>
<li><p><strong>n_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Number of channels for each layer, by default (136, 68, 34).</p></li>
<li><p><strong>n_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Number of layers in each block, by default (2, 2, 1).</p></li>
<li><p><strong>dilations</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – List of dilation rates for the layers, by default None.</p></li>
<li><p><strong>enable_nhwc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable NHWC data format, by default False.</p></li>
<li><p><strong>enable_healpixpad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Flag to enable HEALPix padding, by default False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fme.ace.UNetEncoderConfig.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/ace/models/healpix/healpix_encoder.html#UNetEncoderConfig.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.UNetEncoderConfig.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the UNet Encoder model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>UNet Encoder model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.WeightedMappingLossConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">WeightedMappingLossConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type='MSE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_mean_type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_mean_kwargs=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_mean_weight=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/loss.html#WeightedMappingLossConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.WeightedMappingLossConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Loss configuration class that has the same fields as LossConfig but also
has additional weights field. The build method will apply the weights to
the inputs of the loss function. The loss returned by build will be a
MappingLoss, which takes Dict[str, tensor] as inputs instead of packed
tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'LpLoss'</span></code>, <code class="docutils literal notranslate"><span class="pre">'MSE'</span></code>, <code class="docutils literal notranslate"><span class="pre">'AreaWeightedMSE'</span></code>, <code class="docutils literal notranslate"><span class="pre">'EnsembleLoss'</span></code>], default: <code class="docutils literal notranslate"><span class="pre">'MSE'</span></code>) – the type of the loss function</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – data for a loss function instance of the indicated type</p></li>
<li><p><strong>global_mean_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'LpLoss'</span></code>]], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – the type of the loss function to apply to the global
mean of each sample, by default no loss is applied</p></li>
<li><p><strong>global_mean_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – data for a loss function instance of the indicated
type to apply to the global mean of each sample</p></li>
<li><p><strong>global_mean_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1.0</span></code>) – the weight to apply to the global mean loss
relative to the main loss</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – A dictionary of variable names with individual
weights to apply to their normalized losses</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fme.ace.XarrayDataConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fme.ace.</span></span><span class="sig-name descname"><span class="pre">XarrayDataConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_pattern='*.nc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_repeats=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engine='netcdf4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_dimensions='latlon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_timestep=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype='float32'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_nans=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isel=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fme/core/dataset/config.html#XarrayDataConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fme.ace.XarrayDataConfig" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to the data.</p></li>
<li><p><strong>file_pattern</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">'*.nc'</span></code>) – Glob pattern to match files in the data_path.</p></li>
<li><p><strong>n_repeats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) – Number of times to repeat the dataset (in time). It is up
to the user to ensure that the input dataset to repeat results in
data that is reasonably continuous across repetitions.</p></li>
<li><p><strong>engine</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'netcdf4'</span></code>, <code class="docutils literal notranslate"><span class="pre">'h5netcdf'</span></code>, <code class="docutils literal notranslate"><span class="pre">'zarr'</span></code>], default: <code class="docutils literal notranslate"><span class="pre">'netcdf4'</span></code>) – Backend used in xarray.open_dataset call.</p></li>
<li><p><strong>spatial_dimensions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'healpix'</span></code>, <code class="docutils literal notranslate"><span class="pre">'latlon'</span></code>], default: <code class="docutils literal notranslate"><span class="pre">'latlon'</span></code>) – Specifies the spatial dimensions for the grid, default
is lat/lon. If ‘latlon’, it is assumed that the last two dimensions are
latitude and longitude, respectively. If ‘healpix’, it is assumed that the
last three dimensions are face, height, and width, respectively.</p></li>
<li><p><strong>subset</strong> (<a class="reference internal" href="#fme.ace.Slice" title="fme.core.typing_.Slice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Slice</span></code></a> | <a class="reference internal" href="#fme.ace.TimeSlice" title="fme.core.dataset.config.TimeSlice"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSlice</span></code></a> | <a class="reference internal" href="#fme.ace.RepeatedInterval" title="fme.core.dataset.config.RepeatedInterval"><code class="xref py py-class docutils literal notranslate"><span class="pre">RepeatedInterval</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Slice defining a subset of the XarrayDataset to load. This can
either be a <cite>Slice</cite> of integer indices or a <cite>TimeSlice</cite> of timestamps.
This feature is applied directly to the dataset samples. For example,
if the file(s) have the time coordinate (t0, t1, t2, t3) and
requirements.n_timesteps=2, then subset=Slice(stop=2) will
provide two samples: (t0, t1), (t1, t2).</p></li>
<li><p><strong>infer_timestep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Whether to infer the timestep from the provided data.
This should be set to True (the default) for ACE training. It may
be useful to toggle this to False for applications like downscaling,
which do not depend on the timestep of the data and therefore lack
the additional requirement that the data be ordered and evenly
spaced in time. It must be set to True if n_repeats &gt; 1 in order
to be able to infer the full time coordinate.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">'float32'</span></code>) – Data type to cast the data to. If None, no casting is done. It is
required that ‘torch.{dtype}’ is a valid dtype.</p></li>
<li><p><strong>overwrite</strong> (<a class="reference internal" href="#fme.ace.OverwriteConfig" title="fme.core.dataset.config.OverwriteConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">OverwriteConfig</span></code></a>, default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Optional OverwriteConfig to overwrite loaded field values.</p></li>
<li><p><strong>fill_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="#fme.ace.FillNaNsConfig" title="fme.core.dataset.config.FillNaNsConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">FillNaNsConfig</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Optional FillNaNsConfig to fill NaNs with a constant value.</p></li>
<li><p><strong>isel</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference internal" href="#fme.ace.Slice" title="fme.core.typing_.Slice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Slice</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], default: <code class="docutils literal notranslate"><span class="pre">&lt;factory&gt;</span></code>) – Optional xarray isel arguments to be passed to the dataset. Will
raise ValueError if time is included here, since the subset argument
is used specifically for selecting times. Horizontal dimensions are
also not currently supported.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>If data is stored in a directory with multiple netCDF files which can be
concatenated along the time dimension, use:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fme</span><span class="o">.</span><span class="n">ace</span><span class="o">.</span><span class="n">XarrayDataConfig</span><span class="p">(</span><span class="n">data_path</span><span class="o">=</span><span class="s2">&quot;/some/directory&quot;</span><span class="p">,</span> <span class="n">file_pattern</span><span class="o">=</span><span class="s2">&quot;*.nc&quot;</span><span class="p">)</span> 
</pre></div>
</div>
<p>If data is stored in a single zarr store at <code class="docutils literal notranslate"><span class="pre">/some/directory/dataset.zarr</span></code>,
use:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fme</span><span class="o">.</span><span class="n">ace</span><span class="o">.</span><span class="n">XarrayDataConfig</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data_path</span><span class="o">=</span><span class="s2">&quot;/some/directory&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">file_pattern</span><span class="o">=</span><span class="s2">&quot;dataset.zarr&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;zarr&quot;</span>
<span class="gp">... </span><span class="p">)</span> 
</pre></div>
</div>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="modules.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Modules</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Allen Institute for Artificial Intelligence
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/ai2cm/ace" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">API Reference</a><ul>
<li><a class="reference internal" href="#module-fme">fme</a><ul>
<li><a class="reference internal" href="#fme.Packer"><code class="docutils literal notranslate"><span class="pre">Packer</span></code></a><ul>
<li><a class="reference internal" href="#fme.Packer.pack"><code class="docutils literal notranslate"><span class="pre">Packer.pack()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.StandardNormalizer"><code class="docutils literal notranslate"><span class="pre">StandardNormalizer</span></code></a><ul>
<li><a class="reference internal" href="#fme.StandardNormalizer.from_state"><code class="docutils literal notranslate"><span class="pre">StandardNormalizer.from_state()</span></code></a></li>
<li><a class="reference internal" href="#fme.StandardNormalizer.get_state"><code class="docutils literal notranslate"><span class="pre">StandardNormalizer.get_state()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.get_device"><code class="docutils literal notranslate"><span class="pre">get_device()</span></code></a></li>
<li><a class="reference internal" href="#fme.gradient_magnitude"><code class="docutils literal notranslate"><span class="pre">gradient_magnitude()</span></code></a></li>
<li><a class="reference internal" href="#fme.gradient_magnitude_percent_diff"><code class="docutils literal notranslate"><span class="pre">gradient_magnitude_percent_diff()</span></code></a></li>
<li><a class="reference internal" href="#fme.rmse_of_time_mean"><code class="docutils literal notranslate"><span class="pre">rmse_of_time_mean()</span></code></a></li>
<li><a class="reference internal" href="#fme.root_mean_squared_error"><code class="docutils literal notranslate"><span class="pre">root_mean_squared_error()</span></code></a></li>
<li><a class="reference internal" href="#fme.spherical_area_weights"><code class="docutils literal notranslate"><span class="pre">spherical_area_weights()</span></code></a></li>
<li><a class="reference internal" href="#fme.time_and_global_mean_bias"><code class="docutils literal notranslate"><span class="pre">time_and_global_mean_bias()</span></code></a></li>
<li><a class="reference internal" href="#fme.weighted_mean"><code class="docutils literal notranslate"><span class="pre">weighted_mean()</span></code></a></li>
<li><a class="reference internal" href="#fme.weighted_mean_bias"><code class="docutils literal notranslate"><span class="pre">weighted_mean_bias()</span></code></a></li>
<li><a class="reference internal" href="#fme.weighted_mean_gradient_magnitude"><code class="docutils literal notranslate"><span class="pre">weighted_mean_gradient_magnitude()</span></code></a></li>
<li><a class="reference internal" href="#fme.weighted_std"><code class="docutils literal notranslate"><span class="pre">weighted_std()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-fme.ace">fme.ace</a><ul>
<li><a class="reference internal" href="#fme.ace.AtmosphereCorrectorConfig"><code class="docutils literal notranslate"><span class="pre">AtmosphereCorrectorConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.AugmentationConfig"><code class="docutils literal notranslate"><span class="pre">AugmentationConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.AugmentationConfig.rotate_probability"><code class="docutils literal notranslate"><span class="pre">AugmentationConfig.rotate_probability</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.AugmentationConfig.additional_directional_names"><code class="docutils literal notranslate"><span class="pre">AugmentationConfig.additional_directional_names</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.CappedGELUConfig"><code class="docutils literal notranslate"><span class="pre">CappedGELUConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.CappedGELUConfig.build"><code class="docutils literal notranslate"><span class="pre">CappedGELUConfig.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.ConcatDatasetConfig"><code class="docutils literal notranslate"><span class="pre">ConcatDatasetConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.ConstantConfig"><code class="docutils literal notranslate"><span class="pre">ConstantConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.ConvBlockConfig"><code class="docutils literal notranslate"><span class="pre">ConvBlockConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.ConvBlockConfig.build"><code class="docutils literal notranslate"><span class="pre">ConvBlockConfig.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.CopyWeightsConfig"><code class="docutils literal notranslate"><span class="pre">CopyWeightsConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.CopyWeightsConfig.apply"><code class="docutils literal notranslate"><span class="pre">CopyWeightsConfig.apply()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.CorrectorSelector"><code class="docutils literal notranslate"><span class="pre">CorrectorSelector</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.CorrectorSelector.get_available_types"><code class="docutils literal notranslate"><span class="pre">CorrectorSelector.get_available_types()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.DataLoaderConfig"><code class="docutils literal notranslate"><span class="pre">DataLoaderConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.DataLoaderConfig.zarr_engine_used"><code class="docutils literal notranslate"><span class="pre">DataLoaderConfig.zarr_engine_used</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.DataWriterConfig"><code class="docutils literal notranslate"><span class="pre">DataWriterConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.DownsamplingBlockConfig"><code class="docutils literal notranslate"><span class="pre">DownsamplingBlockConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.DownsamplingBlockConfig.build"><code class="docutils literal notranslate"><span class="pre">DownsamplingBlockConfig.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.EMAConfig"><code class="docutils literal notranslate"><span class="pre">EMAConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.ExistingStepperConfig"><code class="docutils literal notranslate"><span class="pre">ExistingStepperConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.ExistingStepperConfig.get_parameter_initializer"><code class="docutils literal notranslate"><span class="pre">ExistingStepperConfig.get_parameter_initializer()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.ExplicitIndices"><code class="docutils literal notranslate"><span class="pre">ExplicitIndices</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.FillNaNsConfig"><code class="docutils literal notranslate"><span class="pre">FillNaNsConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.ForcingDataLoaderConfig"><code class="docutils literal notranslate"><span class="pre">ForcingDataLoaderConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.FrozenParameterConfig"><code class="docutils literal notranslate"><span class="pre">FrozenParameterConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.GreensFunctionConfig"><code class="docutils literal notranslate"><span class="pre">GreensFunctionConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.GriddedOperations"><code class="docutils literal notranslate"><span class="pre">GriddedOperations</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.GriddedOperations.from_state"><code class="docutils literal notranslate"><span class="pre">GriddedOperations.from_state()</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.GriddedOperations.get_initialization_kwargs"><code class="docutils literal notranslate"><span class="pre">GriddedOperations.get_initialization_kwargs()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.HEALPixRecUNetBuilder"><code class="docutils literal notranslate"><span class="pre">HEALPixRecUNetBuilder</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.HEALPixRecUNetBuilder.build"><code class="docutils literal notranslate"><span class="pre">HEALPixRecUNetBuilder.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.InferenceAggregatorConfig"><code class="docutils literal notranslate"><span class="pre">InferenceAggregatorConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.InferenceConfig"><code class="docutils literal notranslate"><span class="pre">InferenceConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.InferenceDataLoaderConfig"><code class="docutils literal notranslate"><span class="pre">InferenceDataLoaderConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.InferenceDataLoaderConfig.zarr_engine_used"><code class="docutils literal notranslate"><span class="pre">InferenceDataLoaderConfig.zarr_engine_used</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.InferenceEvaluatorAggregatorConfig"><code class="docutils literal notranslate"><span class="pre">InferenceEvaluatorAggregatorConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.InferenceEvaluatorConfig"><code class="docutils literal notranslate"><span class="pre">InferenceEvaluatorConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.InferenceInitialConditionIndices"><code class="docutils literal notranslate"><span class="pre">InferenceInitialConditionIndices</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.InitialConditionConfig"><code class="docutils literal notranslate"><span class="pre">InitialConditionConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.InlineInferenceConfig"><code class="docutils literal notranslate"><span class="pre">InlineInferenceConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.LoggingConfig"><code class="docutils literal notranslate"><span class="pre">LoggingConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.LoggingConfig.configure_logging"><code class="docutils literal notranslate"><span class="pre">LoggingConfig.configure_logging()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.MergeDatasetConfig"><code class="docutils literal notranslate"><span class="pre">MergeDatasetConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.MergeNoConcatDatasetConfig"><code class="docutils literal notranslate"><span class="pre">MergeNoConcatDatasetConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.ModuleSelector"><code class="docutils literal notranslate"><span class="pre">ModuleSelector</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.ModuleSelector.build"><code class="docutils literal notranslate"><span class="pre">ModuleSelector.build()</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.ModuleSelector.get_available_types"><code class="docutils literal notranslate"><span class="pre">ModuleSelector.get_available_types()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.MultiCallConfig"><code class="docutils literal notranslate"><span class="pre">MultiCallConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.MultiCallConfig.names"><code class="docutils literal notranslate"><span class="pre">MultiCallConfig.names</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.NormalizationConfig"><code class="docutils literal notranslate"><span class="pre">NormalizationConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.NormalizationConfig.load"><code class="docutils literal notranslate"><span class="pre">NormalizationConfig.load()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.OceanConfig"><code class="docutils literal notranslate"><span class="pre">OceanConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.OceanCorrectorConfig"><code class="docutils literal notranslate"><span class="pre">OceanCorrectorConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.OneStepAggregatorConfig"><code class="docutils literal notranslate"><span class="pre">OneStepAggregatorConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.OptimizationConfig"><code class="docutils literal notranslate"><span class="pre">OptimizationConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.OverwriteConfig"><code class="docutils literal notranslate"><span class="pre">OverwriteConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.ParameterInitializationConfig"><code class="docutils literal notranslate"><span class="pre">ParameterInitializationConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.ParameterInitializationConfig.build"><code class="docutils literal notranslate"><span class="pre">ParameterInitializationConfig.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.PerturbationSelector"><code class="docutils literal notranslate"><span class="pre">PerturbationSelector</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.PerturbationSelector.get_available_types"><code class="docutils literal notranslate"><span class="pre">PerturbationSelector.get_available_types()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.RecurrentBlockConfig"><code class="docutils literal notranslate"><span class="pre">RecurrentBlockConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.RecurrentBlockConfig.build"><code class="docutils literal notranslate"><span class="pre">RecurrentBlockConfig.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.RepeatedInterval"><code class="docutils literal notranslate"><span class="pre">RepeatedInterval</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.RepeatedInterval.get_boolean_mask"><code class="docutils literal notranslate"><span class="pre">RepeatedInterval.get_boolean_mask()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.SFNO_V0_1_0"><code class="docutils literal notranslate"><span class="pre">SFNO_V0_1_0</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.SFNO_V0_1_0.build"><code class="docutils literal notranslate"><span class="pre">SFNO_V0_1_0.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.SSTPerturbation"><code class="docutils literal notranslate"><span class="pre">SSTPerturbation</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.SchedulerConfig"><code class="docutils literal notranslate"><span class="pre">SchedulerConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.SchedulerConfig.build"><code class="docutils literal notranslate"><span class="pre">SchedulerConfig.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.SingleModuleStepperConfig"><code class="docutils literal notranslate"><span class="pre">SingleModuleStepperConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.SingleModuleStepperConfig.all_names"><code class="docutils literal notranslate"><span class="pre">SingleModuleStepperConfig.all_names</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.SingleModuleStepperConfig.diagnostic_names"><code class="docutils literal notranslate"><span class="pre">SingleModuleStepperConfig.diagnostic_names</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.SingleModuleStepperConfig.get_parameter_initializer"><code class="docutils literal notranslate"><span class="pre">SingleModuleStepperConfig.get_parameter_initializer()</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.SingleModuleStepperConfig.get_stepper"><code class="docutils literal notranslate"><span class="pre">SingleModuleStepperConfig.get_stepper()</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.SingleModuleStepperConfig.input_only_names"><code class="docutils literal notranslate"><span class="pre">SingleModuleStepperConfig.input_only_names</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.SingleModuleStepperConfig.normalize_names"><code class="docutils literal notranslate"><span class="pre">SingleModuleStepperConfig.normalize_names</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.SingleModuleStepperConfig.prognostic_names"><code class="docutils literal notranslate"><span class="pre">SingleModuleStepperConfig.prognostic_names</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.SingleModuleStepperConfig.to_stepper_config"><code class="docutils literal notranslate"><span class="pre">SingleModuleStepperConfig.to_stepper_config()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.SlabOceanConfig"><code class="docutils literal notranslate"><span class="pre">SlabOceanConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.Slice"><code class="docutils literal notranslate"><span class="pre">Slice</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.SphericalFourierNeuralOperatorBuilder"><code class="docutils literal notranslate"><span class="pre">SphericalFourierNeuralOperatorBuilder</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.SphericalFourierNeuralOperatorBuilder.build"><code class="docutils literal notranslate"><span class="pre">SphericalFourierNeuralOperatorBuilder.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.StepperConfig"><code class="docutils literal notranslate"><span class="pre">StepperConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.StepperConfig.all_names"><code class="docutils literal notranslate"><span class="pre">StepperConfig.all_names</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.StepperConfig.from_stepper_state"><code class="docutils literal notranslate"><span class="pre">StepperConfig.from_stepper_state()</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.StepperConfig.get_parameter_initializer"><code class="docutils literal notranslate"><span class="pre">StepperConfig.get_parameter_initializer()</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.StepperConfig.get_stepper"><code class="docutils literal notranslate"><span class="pre">StepperConfig.get_stepper()</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.StepperConfig.input_names"><code class="docutils literal notranslate"><span class="pre">StepperConfig.input_names</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.StepperConfig.loss_names"><code class="docutils literal notranslate"><span class="pre">StepperConfig.loss_names</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.StepperConfig.next_step_forcing_names"><code class="docutils literal notranslate"><span class="pre">StepperConfig.next_step_forcing_names</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.StepperConfig.output_names"><code class="docutils literal notranslate"><span class="pre">StepperConfig.output_names</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.StepperConfig.prognostic_names"><code class="docutils literal notranslate"><span class="pre">StepperConfig.prognostic_names</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.StepperConfig.replace_multi_call"><code class="docutils literal notranslate"><span class="pre">StepperConfig.replace_multi_call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.StepperOverrideConfig"><code class="docutils literal notranslate"><span class="pre">StepperOverrideConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.TimeCoarsenConfig"><code class="docutils literal notranslate"><span class="pre">TimeCoarsenConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.TimeCoarsenConfig.n_coarsened_timesteps"><code class="docutils literal notranslate"><span class="pre">TimeCoarsenConfig.n_coarsened_timesteps()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.TimeSlice"><code class="docutils literal notranslate"><span class="pre">TimeSlice</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.TimestampList"><code class="docutils literal notranslate"><span class="pre">TimestampList</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.TrainConfig"><code class="docutils literal notranslate"><span class="pre">TrainConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.TrainConfig.checkpoint_dir"><code class="docutils literal notranslate"><span class="pre">TrainConfig.checkpoint_dir</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.TrainConfig.output_dir"><code class="docutils literal notranslate"><span class="pre">TrainConfig.output_dir</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.UNetDecoderConfig"><code class="docutils literal notranslate"><span class="pre">UNetDecoderConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.UNetDecoderConfig.build"><code class="docutils literal notranslate"><span class="pre">UNetDecoderConfig.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.UNetEncoderConfig"><code class="docutils literal notranslate"><span class="pre">UNetEncoderConfig</span></code></a><ul>
<li><a class="reference internal" href="#fme.ace.UNetEncoderConfig.build"><code class="docutils literal notranslate"><span class="pre">UNetEncoderConfig.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fme.ace.WeightedMappingLossConfig"><code class="docutils literal notranslate"><span class="pre">WeightedMappingLossConfig</span></code></a></li>
<li><a class="reference internal" href="#fme.ace.XarrayDataConfig"><code class="docutils literal notranslate"><span class="pre">XarrayDataConfig</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>